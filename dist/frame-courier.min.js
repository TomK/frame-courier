!function(){"use strict";let e=null,t={};window===window.top&&o(e="",-1,window.origin);const n={LOADED:"_loaded",PROBE:"_probe",READY:"_ready",MESSAGE_RESPONSE:"_message_response"},r={};function o(e,n,r){const o={id:n,name:e};void 0!==r&&(o.origin=r),t[e]?Object.assign(t[e],o):t[e]=o}function i(t,n,r,o){return{messageId:t+":"+l(Date.now()+n+o),event:t,to:n,toOrigin:r,from:e,fromOrigin:window.origin,payload:o}}function a(e,n,r,o){const a=t[e];if(a){const t=i(n,e,a.origin,r),c=a.id<0?window.top:window.top.frames[a.id];c?s(c,a.origin,t,o):console.warn("target has been removed")}else console.warn("frame does not exist",e)}function s(e,t,n,r){r&&c(d(n.messageId),r),e.postMessage(JSON.stringify(n),t)}function c(e,t){r.hasOwnProperty(e)||(r[e]=[]),r[e].push(t)}function d(e){return n.MESSAGE_RESPONSE+":"+l(e)}if(window.addEventListener("message",t=>{if(t.isTrusted&&t.data){let n;try{n=JSON.parse(t.data)}catch(e){return}if(["event","to","toOrigin","from","fromOrigin","payload"].every(e=>n.hasOwnProperty(e))&&!("*"!==n.toOrigin&&n.toOrigin!==window.origin||null!==e&&e!==n.to)&&r.hasOwnProperty(n.event)){const e=(e,r)=>{const o=i(d(n.messageId),n.from,n.fromOrigin,e);s(t.source,t.origin,o,r)};r[n.event].forEach(r=>{r(n.payload,e,t.source,t.origin)})}}}),window===window.top){function f(e){e.length&&(e.forEach(e=>{if(e.hasAttribute("courier-name")){const n=e.getAttribute("courier-name");n&&t[n]&&delete t[n]}}),m())}function u(e){for(let t=0;t<window.frames.length;t++)if(e.contentWindow===window.frames[t])return t;return!1}function m(){document.querySelectorAll("iframe").forEach(e=>{if(e.hasAttribute("courier-name")){const t=u(e);!1!==t&&o(e.getAttribute("courier-name"),t)}});const e=l(JSON.stringify(t));Object.keys(t).filter(e=>t[e].origin).forEach(r=>{a(r,n.PROBE,"hello "+e,(n,o)=>{n==="send "+e&&o({name:r,frames:t})})})}window.MutationObserver?new MutationObserver(e=>{e.forEach(e=>{Array.from(e.removedNodes).filter(e=>e.nodeType===Node.ELEMENT_NODE).forEach(e=>{f(e.matches("iframe")?[e]:e.querySelectorAll("iframe"))})})}).observe(document,{subtree:!0,childList:!0}):document.addEventListener("DOMNodeRemoved",function(e){e.target.nodeType===Node.ELEMENT_NODE&&f(e.target.matches("iframe")?[e.target]:e.target.querySelectorAll("iframe"))}),c(n.LOADED,(e,t,n,r)=>{document.querySelectorAll("iframe").forEach(e=>{if(e.hasAttribute("courier-name")){const t=e.getAttribute("courier-name"),i=u(e);e.contentWindow===n&&!1!==i&&o(t,i,r)}}),m()})}else{s(window.top,"*",i(n.LOADED,"","*","hello"));let r=!1;c(n.PROBE,(o,i)=>{const s=l(JSON.stringify(t)),c=o.split(" ",2);s!==c[1]&&i("send "+c[1],o=>{e=o.name,t=o.frames,r||(r=!0,document.dispatchEvent(new CustomEvent("frame-courier-ready",{detail:{name:e}})),a("",n.READY,e))})})}function l(e){let t,n,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)r=(r<<5)-r+(n=e.charCodeAt(t)),r|=0;return String(r)}var w={listen:c,send:a,name:function(){return e}};window.FrameCourier=w}();
